# Denmark Parliament Data Processing

This project involves processing data from the Danish Parliament, specifically focusing on transcripts and video links from parliamentary sessions.

## Folder Structure

- **links/**: Contains CSV files with links to transcripts and generic video links. The main file is `danish_parliament_meetings_full_links.csv`, which includes columns for HTML links, generic video links, transcript IDs, year, and part.

## Scripts and Notebooks

- **getting_session_links.ipynb**: This Jupyter notebook is used to extract relevant links to transcripts and videos from the Danish Parliament's website. It processes the HTML of each session page to retrieve transcript and video links, storing them in a CSV file.

- **get_media_info.py**: A Python script that retrieves the m3u8 URL for each generic video link listed in the `danish_parliament_meetings_full_links.csv` file.

## Known Issues and Workarounds

As of January 7th, 2024, the streaming links generated by `get_media_info.py` are no longer working directly. However, we've identified that when clicking the play button on the video player, the website makes API calls to Kaltura's CDN that return the correct streaming URLs.

Example API call format:
```
https://cdnapisec.kaltura.com/p/{partner_id}/sp/{partner_id}00/playManifest/entryId/{entry_id}/flavorIds/{flavor_id}/format/applehttp/protocol/https/a.m3u8
```

The API calls include additional parameters like:
- `referrer`: Base64 encoded referrer URL
- `playSessionId`: Unique session identifier
- `clientTag`: HTML5 player version
- `uiConfId`: UI configuration ID
- `responseFormat`: Response format (jsonp)
- `callback`: JSONP callback function

Future improvements could involve:
1. Monitoring and replicating these API calls directly
2. Extracting the correct streaming URLs from the API responses
3. Updating the script to use this new approach for obtaining working streaming links

## Usage

1. **Transcript Downloading**: Use the transcript links from the `links/` folder to download the HTML content of each transcript. The `getting_session_links.ipynb` notebook contains code to process these HTML files and extract speech segments.

2. **Video URL Retrieval**: The `get_media_info.py` script can be used to obtain m3u8 URLs for video streaming from the generic video links. Note that as of January 2024, additional work is needed to obtain working streaming URLs through the API calls described above.

This setup allows for comprehensive data extraction and processing of Danish parliamentary sessions, facilitating analysis and research.
